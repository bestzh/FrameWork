# 基于第九大陆（C9）的功能设计文档

## 🎮 第九大陆核心功能分析

### C9的核心特色功能

1. **无锁定战斗系统** - 流畅的动作战斗
2. **连招系统** - 技能可以组合成连招
3. **技能系统** - 主动技能、被动技能、觉醒技能
4. **装备系统** - 强化、附魔、品质系统
5. **副本系统** - 普通、困难、地狱难度
6. **职业系统** - 多职业分支，每个职业有独特玩法
7. **任务系统** - 主线任务、支线任务、日常任务
8. **PVP系统** - 竞技场、排名系统（可选）

---

## 📋 功能实现优先级

### 🔴 第一阶段：核心战斗系统（已完成基础）

#### ✅ 已完成
- [x] 无锁定战斗系统基础
- [x] 连招系统基础（ComboManager）
- [x] 技能系统基础（SkillSystem）
- [x] 动画系统

#### ⚠️ 需要完善
- [ ] **连招系统增强**
  - [ ] 连招伤害递增
  - [ ] 连击数显示
  - [ ] 连招取消机制
  - [ ] 空中连招
  
- [ ] **技能系统完善**
  - [ ] 技能树系统
  - [ ] 技能升级
  - [ ] 被动技能
  - [ ] 觉醒技能（大招）

- [ ] **战斗手感优化**
  - [ ] 受击反馈
  - [ ] 击飞/击倒效果
  - [ ] 霸体系统
  - [ ] 无敌帧

### 🟡 第二阶段：城镇和NPC系统（部分完成）

#### ✅ 已完成
- [x] NPC系统
- [x] 对话系统（单段/多段）
- [x] 对话选项系统
- [x] 任务配置表

#### ⚠️ 需要完善
- [ ] **任务系统（C9风格：等级触发）**
  - [x] 任务配置表（支持等级要求）
  - [ ] 任务UI界面
  - [ ] 任务管理器（Lua）
  - [ ] 任务进度追踪
  - [ ] 任务奖励发放
  - [ ] **NPC对话时根据玩家等级显示可接取任务**
  - [ ] **任务按等级分层（1-5级、5-10级、10-15级等）**
  
- [ ] **商店系统**
  - [ ] 商店UI
  - [ ] 商品配置
  - [ ] 购买/出售逻辑
  
- [ ] **技能导师系统**
  - [ ] 技能学习UI
  - [ ] 技能升级UI
  - [ ] 技能树UI

### 🟢 第三阶段：装备和成长系统

#### ⚠️ 需要实现
- [ ] **装备系统**
  - [ ] 装备数据表
  - [ ] 装备品质系统（白/绿/蓝/紫/橙）
  - [ ] 装备词条系统
  - [ ] 装备强化系统
  - [ ] 装备附魔系统
  
- [ ] **角色成长**
  - [ ] 属性点分配
  - [ ] 等级上限提升
  - [ ] 转职系统（可选）

### 🔵 第四阶段：副本系统完善

#### ⚠️ 需要实现
- [ ] **副本难度系统**
  - [ ] 普通难度
  - [ ] 困难难度
  - [ ] 地狱难度
  - [ ] 难度奖励差异
  
- [ ] **副本机制**
  - [ ] 房间系统
  - [ ] 小怪生成
  - [ ] Boss战
  - [ ] 宝箱系统
  - [ ] 评分系统（S/A/B/C）

---

## 🎯 C9特色功能详细设计

### 1. 连招系统增强

#### 连招伤害递增
```lua
-- 连招伤害倍率
local comboMultiplier = {
    [1] = 1.0,   -- 第一段：100%
    [2] = 1.2,   -- 第二段：120%
    [3] = 1.5,   -- 第三段：150%
    [4] = 2.0,   -- 第四段：200%
    [5] = 2.5    -- 第五段：250%
}
```

#### 连击数显示
- 显示在屏幕中央或角色头顶
- 连击数越高，显示效果越炫酷
- 连击数达到一定值有额外奖励

#### 连招取消机制
- 普通攻击可以取消技能后摇
- 技能可以取消普通攻击
- 闪避可以取消任何动作

### 2. 技能树系统

#### 技能树结构
```
基础技能
├── 分支1：近战专精
│   ├── 重击 → 重击强化 → 重击大师
│   ├── 连斩 → 连斩强化 → 连斩大师
│   └── 旋风斩 → 旋风斩强化 → 旋风斩大师
├── 分支2：远程专精
│   ├── 火球术 → 火球术强化 → 火球术大师
│   ├── 冰箭 → 冰箭强化 → 冰箭大师
│   └── 闪电链 → 闪电链强化 → 闪电链大师
└── 分支3：辅助专精
    ├── 狂暴 → 狂暴强化 → 狂暴大师
    └── 护盾 → 护盾强化 → 护盾大师
```

#### 技能升级
- 每个技能可以升级3次
- 升级消耗技能点
- 升级提升伤害、减少冷却、增加效果

### 3. 装备系统

#### 装备品质
- **白色（普通）** - 基础属性
- **绿色（优秀）** - +1条随机词条
- **蓝色（精良）** - +2条随机词条
- **紫色（史诗）** - +3条随机词条
- **橙色（传说）** - +4条随机词条 + 特殊效果

#### 装备强化
- 强化等级：+1 到 +15
- 强化成功率递减
- 强化失败可能降级或损坏
- 强化石消耗

#### 装备附魔
- 可以附魔多个词条
- 词条有等级（1-10级）
- 附魔消耗附魔石
- 可以覆盖已有词条

### 4. 副本难度系统

#### 难度差异
| 难度 | 敌人血量 | 敌人伤害 | 经验奖励 | 金币奖励 | 装备掉落率 |
|------|---------|---------|---------|---------|-----------|
| 普通 | 100%    | 100%    | 100%    | 100%    | 100%      |
| 困难 | 150%    | 120%    | 150%    | 150%    | 150%      |
| 地狱 | 200%    | 150%    | 200%    | 200%    | 200%      |

#### 评分系统
- **S级** - 无伤通关 + 快速通关
- **A级** - 少量受伤 + 较快通关
- **B级** - 中等受伤 + 正常通关
- **C级** - 大量受伤或超时

---

## 🚀 实现计划

### 第一步：完善连招系统（1-2天）
1. 实现连招伤害递增
2. 添加连击数显示
3. 实现连招取消机制

### 第二步：实现任务系统（2-3天）- C9风格
1. **任务触发机制**：玩家达到等级后，与NPC对话显示可接取任务
2. 创建任务UI（显示可接取任务列表，按等级排序）
3. 创建任务管理器（Lua）
4. **NPC对话集成**：对话时根据玩家等级显示"查看任务"选项
5. 任务进度追踪和奖励发放

**C9任务系统特点：**
- 任务按等级分层（1-5级新手任务、5-10级进阶任务等）
- 玩家达到等级后，NPC对话中会出现"查看任务"选项
- 任务列表按等级要求排序显示
- 未达到等级要求的任务不显示或显示为"等级不足"

### 第三步：实现商店系统（2-3天）
1. 创建商店UI
2. 创建商店管理器
3. 集成到对话系统

### 第四步：实现装备系统（3-5天）
1. 创建装备数据表
2. 实现装备品质系统
3. 实现装备强化系统
4. 实现装备附魔系统

### 第五步：完善副本系统（2-3天）
1. 实现难度选择
2. 实现评分系统
3. 优化Boss战

---

## 📝 下一步行动

**建议优先完成：**
1. ✅ 任务系统（配置表已完成）
2. ✅ 商店系统（基础框架）
3. ⚠️ 连招系统增强（提升战斗体验）
4. ⚠️ 装备系统（核心成长系统）

告诉我你想先实现哪个功能，我会帮你详细设计和实现！

