-- 技能系统Lua封装
-- 提供更简洁的Lua API来管理技能

local SkillHelper = {}

-- 释放技能
-- skillName: 技能名称
-- 返回: true/false（是否成功释放）
function SkillHelper.CastSkill(skillName)
    -- 需要从PlayerController获取SkillSystem
    local playerObj = CS.UnityEngine.GameObject.FindWithTag("Player")
    if playerObj == nil then
        print("[SkillHelper] 警告: 未找到玩家对象")
        return false
    end
    
    local skillSystem = playerObj:GetComponent(CS.SkillSystem)
    if skillSystem == nil then
        print("[SkillHelper] 警告: 玩家对象没有SkillSystem组件")
        return false
    end
    
    return skillSystem:TryCastSkill(skillName)
end

-- 检查技能是否在冷却中
-- skillName: 技能名称
-- 返回: true/false
function SkillHelper.IsSkillOnCooldown(skillName)
    local playerObj = CS.UnityEngine.GameObject.FindWithTag("Player")
    if playerObj == nil then return false end
    
    local skillSystem = playerObj:GetComponent(CS.SkillSystem)
    if skillSystem == nil then return false end
    
    return skillSystem:IsSkillOnCooldown(skillName)
end

-- 获取技能冷却进度（0-1）
-- skillName: 技能名称
-- 返回: 冷却进度（0表示冷却中，1表示可以使用）
function SkillHelper.GetSkillCooldownProgress(skillName)
    local playerObj = CS.UnityEngine.GameObject.FindWithTag("Player")
    if playerObj == nil then return 1.0 end
    
    local skillSystem = playerObj:GetComponent(CS.SkillSystem)
    if skillSystem == nil then return 1.0 end
    
    return skillSystem:GetSkillCooldownProgress(skillName)
end

-- 中断技能
function SkillHelper.InterruptSkill()
    local playerObj = CS.UnityEngine.GameObject.FindWithTag("Player")
    if playerObj == nil then return end
    
    local skillSystem = playerObj:GetComponent(CS.SkillSystem)
    if skillSystem ~= nil then
        skillSystem:InterruptSkill()
    end
end

-- 技能事件常量
SkillHelper.Events = {
    SKILL_CAST_START = "SKILL_CAST_START",
    SKILL_CAST_COMPLETE = "SKILL_CAST_COMPLETE",
}

return SkillHelper

